<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="color-scheme" content="dark light">
  <meta name="description" content="Visor 3D interactivo con tecnología WebGPU y WebGL">
  <meta name="gpu-preference" content="high-performance">
  <title>Visor 3D</title>
  <link rel="preconnect" href="https://esm.sh" crossorigin>
  <link rel="preload" href="assets/windyD.glb" as="fetch" type="model/gltf-binary" crossorigin>
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/responsive.css">
  <script type="module" src="https://esm.sh/@google/model-viewer@4.1.1?bundle"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="brand-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="url(#gradient1)"/>
            <path d="M2 17L12 22L22 17V7L12 12L2 7V17Z" fill="url(#gradient2)" opacity="0.7"/>
            <defs>
              <linearGradient id="gradient1" x1="2" y1="2" x2="22" y2="12" gradientUnits="userSpaceOnUse">
                <stop stop-color="#00D9FF"/>
                <stop offset="1" stop-color="#7B61FF"/>
              </linearGradient>
              <linearGradient id="gradient2" x1="2" y1="7" x2="22" y2="22" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7B61FF"/>
                <stop offset="1" stop-color="#FF61E6"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <h1 class="title">V3D Interactivo</h1>
      </div>
      <div class="top-actions">
        <input type="file" id="fileInput" accept=".glb,.gltf" aria-label="Seleccionar archivo de modelo 3D" title="Cargar modelo GLB o GLTF">
        <button id="btnUpload" class="icon-btn" aria-label="Cargar modelo" title="Cargar modelo">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
          </svg>
        </button>
        <button id="btnShare" class="icon-btn" aria-label="Compartir" title="Compartir">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="18" cy="5" r="3"></circle>
            <circle cx="6" cy="12" r="3"></circle>
            <circle cx="18" cy="19" r="3"></circle>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
          </svg>
        </button>
        <button id="btnAI" class="icon-btn" aria-label="Analizar con IA" title="Analizar con IA">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"/>
            <path d="M12 6v6l4 2"/>
          </svg>
        </button>
        <a href="modelo/modelo.html" class="icon-btn" aria-label="Abrir vista del modelo" title="Vista avanzada">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6M15 3h6v6M10 14L21 3"/>
          </svg>
        </a>
        <button id="btnTheme" class="icon-btn" aria-label="Cambiar tema" title="Alternar tema">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </button>
        <button id="btnFullscreen" class="icon-btn" aria-label="Pantalla completa" title="Pantalla completa">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
          </svg>
        </button>
      </div>
    </header>

    <main class="viewer-area">
      <div class="viewer-wrap" id="viewerWrap">
        <div class="loader" id="loader">
          <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner-glow"></div>
          </div>
          <div class="progress-track">
            <div id="progressBar" class="progress-bar"></div>
          </div>
          <div id="progressText" class="progress-text">Cargando modelo...</div>
        </div>

        <model-viewer id="viewer"
                      src="assets/windyD.glb"
                      alt="V3D Interactivo"
                      camera-controls
                      auto-rotate
                      rotation-per-second="0.5"
                      interaction-prompt="auto"
                      exposure="1.2"
                      shadow-intensity="1.2"
                      shadow-softness="0.8"
                      environment-image="neutral"
                      ar
                      ar-modes="webxr scene-viewer quick-look"
                      crossorigin="anonymous"
                      loading="lazy">
          <div slot="fallback" class="fallback-message">
            <p>Tu navegador no soporta visualización 3D (WebGPU/WebGL)</p>
            <p>Actualiza tu navegador para una mejor experiencia</p>
          </div>
        </model-viewer>

        <div class="hud">
          <button id="btnVR" class="btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7z"/>
              <path d="M8 12h8"/>
            </svg>
            <span>VR</span>
          </button>
          <button id="btnRotate" class="btn-primary" aria-pressed="true">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
            </svg>
            <span>Detener</span>
          </button>
          <button id="btnReset" class="btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
              <path d="M3 3v5h5"/>
            </svg>
            <span>Reiniciar</span>
          </button>
          <div class="speed-control">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
            <select id="speed" class="select-speed" aria-label="Velocidad de rotación">
              <option value="0.25">Lento</option>
              <option value="0.5" selected>Normal</option>
              <option value="1">Rápido</option>
              <option value="1.5">Muy rápido</option>
            </select>
          </div>
        </div>
      </div>

      <div class="info-panel">
        <div class="info-card">
          <div class="info-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <div class="info-content">
            <h3>Controles táctiles</h3>
            <p>Desliza para rotar • Pellizca para zoom</p>
          </div>
        </div>
        <div class="info-card">
          <div class="info-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
            </svg>
          </div>
          <div class="info-content">
            <h3>Realidad aumentada</h3>
            <p>Disponible en dispositivos compatibles</p>
          </div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <p class="footer-title">Tecnología</p>
          <p class="footer-text" id="techStack">WebGPU • WebGL • AR Ready</p>
        </div>
        <div class="footer-section">
          <p class="footer-title">Compatibilidad</p>
          <p class="footer-text">Móvil • Tablet • Desktop</p>
        </div>
        <div class="footer-section">
          <p class="footer-title">Año</p>
          <p class="footer-text">2025</p>
        </div>
      </div>
    </footer>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>